<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>학생 지원 및 출석 관리 시스템</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f3f4f6; }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .status-btn.active { border-color: transparent; ring: 2px; ring-offset: 2px; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Navigation -->
    <nav class="bg-indigo-600 text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-user-graduate text-2xl"></i>
                    <span class="font-bold text-xl tracking-tight">에듀케어 관리 시스템</span>
                </div>
                <div class="hidden md:flex space-x-4">
                    <button onclick="showTab('dashboard')" class="hover:bg-indigo-500 px-3 py-2 rounded-md text-sm font-medium">대시보드</button>
                    <button onclick="showTab('students')" class="hover:bg-indigo-500 px-3 py-2 rounded-md text-sm font-medium">학생 등록</button>
                    <button onclick="showTab('attendance')" class="hover:bg-indigo-500 px-3 py-2 rounded-md text-sm font-medium">출석 체크</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Navigation -->
    <div class="md:hidden flex justify-around bg-white border-b py-2 text-indigo-600 font-medium">
        <button onclick="showTab('dashboard')"><i class="fas fa-chart-line"></i></button>
        <button onclick="showTab('students')"><i class="fas fa-users"></i></button>
        <button onclick="showTab('attendance')"><i class="fas fa-check-square"></i></button>
    </div>

    <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        
        <!-- Dashboard Tab -->
        <section id="dashboard" class="tab-content active space-y-6">
            <h2 class="text-2xl font-bold text-gray-900">시스템 요약</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card p-6 border-l-4 border-indigo-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500 font-bold">전체 등록 학생</p>
                            <h3 id="stat-total" class="text-3xl font-bold">0명</h3>
                        </div>
                        <i class="fas fa-users text-indigo-200 text-4xl"></i>
                    </div>
                </div>
                <div class="card p-6 border-l-4 border-green-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500 font-bold">오늘 출석</p>
                            <h3 id="stat-present" class="text-3xl font-bold text-green-600">0명</h3>
                        </div>
                        <i class="fas fa-user-check text-green-200 text-4xl"></i>
                    </div>
                </div>
                <div class="card p-6 border-l-4 border-red-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500 font-bold">오늘 결석</p>
                            <h3 id="stat-absent" class="text-3xl font-bold text-red-600">0명</h3>
                        </div>
                        <i class="fas fa-user-times text-red-200 text-4xl"></i>
                    </div>
                </div>
            </div>

            <!-- Graph Placeholder / Recent Activity -->
            <div class="card p-6">
                <h3 class="font-bold mb-4">최근 출석 추이</h3>
                <div class="h-32 bg-gray-100 rounded-lg flex items-end justify-around p-2">
                    <div class="w-8 bg-indigo-400 rounded-t" style="height: 40%"></div>
                    <div class="w-8 bg-indigo-500 rounded-t" style="height: 65%"></div>
                    <div class="w-8 bg-indigo-400 rounded-t" style="height: 50%"></div>
                    <div class="w-8 bg-indigo-600 rounded-t" style="height: 85%"></div>
                    <div class="w-8 bg-indigo-500 rounded-t" style="height: 70%"></div>
                </div>
                <p class="text-xs text-center mt-2 text-gray-400">최근 5일간의 출석률 데이터</p>
            </div>
        </section>

        <!-- Students Registration Tab -->
        <section id="students" class="tab-content space-y-6">
            <h2 class="text-2xl font-bold text-gray-900">학생 정보 관리</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Registration Form -->
                <div class="card p-6 h-fit">
                    <h3 class="font-bold text-lg mb-4">새 학생 등록</h3>
                    <form id="student-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">이름</label>
                            <input type="text" id="student-name" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">학번/ID</label>
                            <input type="text" id="student-id" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                        </div>
                        <button type="submit" class="w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition">학생 추가</button>
                    </form>
                </div>

                <!-- Student List -->
                <div class="lg:col-span-2 card p-6">
                    <h3 class="font-bold text-lg mb-4">등록된 학생 목록</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">이름</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">학번</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">관리</th>
                                </tr>
                            </thead>
                            <tbody id="student-list-body" class="bg-white divide-y divide-gray-200">
                                <!-- Dynamic Content -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Attendance Check Tab -->
        <section id="attendance" class="tab-content space-y-6">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-900">일일 출석 체크</h2>
                <span id="current-date" class="bg-white px-4 py-2 rounded-full shadow text-sm font-bold text-indigo-600 border border-indigo-100"></span>
            </div>
            
            <div class="card overflow-hidden">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">학생 정보</th>
                            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">상태 설정</th>
                        </tr>
                    </thead>
                    <tbody id="attendance-list-body" class="bg-white divide-y divide-gray-200">
                        <!-- Dynamic Content -->
                    </tbody>
                </table>
                <div class="p-6 bg-gray-50 text-right">
                    <button onclick="saveAttendance()" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 font-bold transition">오늘 기록 저장</button>
                </div>
            </div>
        </section>

    </main>

    <!-- Custom Alert Modal -->
    <div id="alert-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h4 id="alert-title" class="text-lg font-bold mb-2">알림</h4>
            <p id="alert-message" class="text-gray-600 mb-6"></p>
            <button onclick="closeAlert()" class="w-full bg-indigo-600 text-white py-2 rounded-md">확인</button>
        </div>
    </div>

    <script>
        // State Management
        let students = JSON.parse(localStorage.getItem('students')) || [];
        let attendanceRecord = JSON.parse(localStorage.getItem('attendanceRecord')) || {};

        // Initialization
        window.onload = () => {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('current-date').textContent = today;
            updateUI();
        };

        // Tab Navigation
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
        }

        // Student Management Logic
        document.getElementById('student-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('student-name').value;
            const id = document.getElementById('student-id').value;

            if (students.find(s => s.id === id)) {
                showAlert('중복 오류', '이미 등록된 학번입니다.');
                return;
            }

            students.push({ id, name });
            localStorage.setItem('students', JSON.stringify(students));
            e.target.reset();
            updateUI();
            showAlert('성공', '학생이 등록되었습니다.');
        });

        function deleteStudent(id) {
            students = students.filter(s => s.id !== id);
            localStorage.setItem('students', JSON.stringify(students));
            updateUI();
        }

        // Attendance Logic
        function setAttendance(studentId, status) {
            const today = new Date().toISOString().split('T')[0];
            if (!attendanceRecord[today]) attendanceRecord[today] = {};
            attendanceRecord[today][studentId] = status;
            localStorage.setItem('attendanceRecord', JSON.stringify(attendanceRecord));
            updateUI();
        }

        function saveAttendance() {
            showAlert('저장 완료', '오늘의 출석 상태가 시스템에 기록되었습니다.');
            updateUI();
        }

        // UI Update Function
        function updateUI() {
            const today = new Date().toISOString().split('T')[0];
            const studentListBody = document.getElementById('student-list-body');
            const attendanceListBody = document.getElementById('attendance-list-body');
            const todaysData = attendanceRecord[today] || {};

            // Update Dashboard Stats
            document.getElementById('stat-total').textContent = `${students.length}명`;
            const presentCount = Object.values(todaysData).filter(s => s === 'present').length;
            const absentCount = Object.values(todaysData).filter(s => s === 'absent').length;
            document.getElementById('stat-present').textContent = `${presentCount}명`;
            document.getElementById('stat-absent').textContent = `${absentCount}명`;

            // Update Student Table
            studentListBody.innerHTML = '';
            students.forEach(student => {
                studentListBody.innerHTML += `
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap font-medium text-gray-900">${student.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-gray-500">${student.id}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button onclick="deleteStudent('${student.id}')" class="text-red-600 hover:text-red-900"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });

            // Update Attendance Table
            attendanceListBody.innerHTML = '';
            if (students.length === 0) {
                attendanceListBody.innerHTML = `<tr><td colspan="2" class="px-6 py-10 text-center text-gray-400">등록된 학생이 없습니다.</td></tr>`;
            } else {
                students.forEach(student => {
                    const status = todaysData[student.id] || 'none';
                    attendanceListBody.innerHTML += `
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900">${student.name}</div>
                                <div class="text-xs text-gray-500">${student.id}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-center">
                                <div class="flex justify-center space-x-2">
                                    <button onclick="setAttendance('${student.id}', 'present')" class="px-3 py-1 rounded-md text-xs font-bold border ${status === 'present' ? 'bg-green-600 text-white border-green-600' : 'bg-white text-green-600 border-green-200 hover:bg-green-50'} transition">출석</button>
                                    <button onclick="setAttendance('${student.id}', 'late')" class="px-3 py-1 rounded-md text-xs font-bold border ${status === 'late' ? 'bg-yellow-500 text-white border-yellow-500' : 'bg-white text-yellow-600 border-yellow-200 hover:bg-yellow-50'} transition">지각</button>
                                    <button onclick="setAttendance('${student.id}', 'absent')" class="px-3 py-1 rounded-md text-xs font-bold border ${status === 'absent' ? 'bg-red-600 text-white border-red-600' : 'bg-white text-red-600 border-red-200 hover:bg-red-50'} transition">결석</button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
            }
        }

        // Alert Modal Helper
        function showAlert(title, message) {
            document.getElementById('alert-title').textContent = title;
            document.getElementById('alert-message').textContent = message;
            document.getElementById('alert-modal').classList.remove('hidden');
        }

        function closeAlert() {
            document.getElementById('alert-modal').classList.add('hidden');
        }
    </script>
</body>
</html>